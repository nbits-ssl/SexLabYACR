SexLab Yet Another Combat Rape        but still simple & lightweight
====================================================================

******* このModはアルファ版です。変なことになっても泣かない ********
*******       入れる前のセーブデータのバックアップ必須      ********

SSL用の戦闘レイプMod。Defeatが自環境ではうまく動かないため、簡易的な
ものを作成しました。
元々は裸のPC/フォロワーにペナルティを与える目的で製作したものです。

基本和姦好きで戦闘でレイプされることにあまり重きをおいていないので、
通常のゲームプレイにあまり影響が出ないように、なおかつ気を抜くとたま
にレイプされるような感じが目標です。

自環境がフォロワーをたくさん連れて敵もたくさん沸かせる環境なので、
複雑な機能の実装の予定はありません。
(一番忙しい戦闘時にいろいろするModなため、乱打戦になると大変)


## 概要

* 防御せずに直接攻撃を受けた時に、MCMの設定に応じた条件・確率でレイプが
  発動します。
* 既存の鎧破壊Modの併用を想定していますが、このMod自体にも女性の胴装備
  のみのアーマーブレイクは実装しています。

* PCがレイプされた場合、フォロワーは戦闘を停止してブリードアウト状態にな
  ります。PCがレイプから逃れるとこのブリードアウト状態は解除されます。
* PC/女性フォロワーを1人＋5人まで認識します。全ての機能が適用されます。
  PCについてはMCMで有効/無効を切り替えられます。
* 男性フォロワーとペットを5人/3匹まで認識します。ペットはブリードアウト
  になる代わりに麻痺状態になります。
* フォロワーでないNPCは認識しません。

* レイプを開始した攻め側キャラに攻撃可能です。
* PC/フォロワーがレイプされているときに↑の横槍が入ると、中断します。
  「だいたいの場合は横槍が入る」ことを想定して機能は実装しています。

* 1アニメーションステージに1回、MCMから設定できるホットキーで下記を
  試みることができます

  * 「抵抗する」成功したら直接のレイパー以外はすぐに襲ってきます
  * 「助けを呼ぶ」男orペットフォロワーが近くにいる時限定
  * 「全てをあきらめる」ロードボタンの代わりです

* フォロワーがブリードアウト状態の時、近くにレイプ可能な非戦闘NPCがいれ
  ばフォロワーをレイプします
* 敵が山賊などの人間種族の場合、ギャラリーがいればはやし立てます。
  (TFC発動時は見えません)


## 注意事項

* ** デフォルトでプレイヤーに対するレイプが有効になっています。**
* 発生確率を100%にしても、必ず発生するわけではありません。

* モーション中に死亡した死体硬直防止処理のため、床をすり抜けて消える死体
  が発生する可能性があります。ある程度は防止しますが、達人魔法とかでは発
  生するかもしれません。あまりあることではないので、仕様で。
* ユニーク装備の鎧とかでも容赦なく壊します。

* PCレイプ時、諸々の事情により移動力を落とす魔法をPCにかけています。
  レイプからの復帰時に症状が残っている場合は、少しだけスプリントしてくだ
  さい。
* 人間2Pと3PはSexLab MCMから設定できるレイプアニメーションでなければなり
  ません。合致するアニメーションがない場合、行為は中断されます。この場合
  でも終了処理は正常に走ります。

* 保護/不死じゃないフォロワーのことはまったく考えていません。PCレイプ時に
  フォロワーをノックダウンさせる際、実際にダメージを与えているため、現状
  だと確実に死亡します。手が空いたら一時的に保護属性をつける予定です。
* 殴り合いイベントのこととかまったく考えていません。


## 既知の問題

* レイプ中のPC/フォロワーは無敵化しているため、エフェクトを加えるModがあ
  った場合、動作しません。そういうModがあったらお知らせください。
* フォロワーがレイプされた時、他のフォロワーが助けに行かず戦闘状態を解除
  することがあります。自分で横槍を入れてください。
* 機能発動の後遺症を残さないために、戦闘が終わったタイミングでResetAIを発
  行しているため、フォロワーが抜刀と納刀を繰り返すことがあります。放って
  おけば治ります。
* たまに横槍を入れても止まらずに無敵化するレイパーがいます。アニメーション
  が1段階進むと無敵化が解けますので、再度横槍を入れてください。
* ごくまれですが、フォロワーがブリードアウト状態になって復帰しない状態にな
  る可能性があります。セルロードなどの再起動時に治ります。
* 動作がおかしくなることはないと思いますが、PCが召喚とか死霊術を使った場合、
  想定通りに事が進まないと思います。(DLCなしのバニラの範囲の召喚は、何と
  なく対策コードは入っています)


## 必須

* Skyrim OE + Dawnguard + Dragonborn
* Skyrim SexLab 1.62
* SexLab Aroused Redux


## 併用推奨

下記の鎧破壊Modのいずれか(なくても動作します)

* Loot and Degradation
* Equipment Durability System
* The Amazing World of Bikini Armor - Armor Break
* Ecchina Armor Break

破壊ではなく脱衣を使いたい方でフォロワーの自動着直しが必要な方は、
SexLab RapeSpellのおまけについているMySexlabSupplyなどを導入してください


## 製作環境で関係ありそうなModや設定

* SexLab基本設定"Disable Starting Teleport"をOFFに
* FollowerLivePackage (多くてもPC+女性フォロワー3人までくらいです)
* Loot and Degradation
* Armor Rating Rescaled - SKSE
* 戦闘関係はCombat Evolvedの設定値消去版だけ
* SexLabのシーン自体をフックするAdd On(SLSOとか)なし
* Fresh Women Darkness
* More Nasty Critters 11.1D


## 競合について

* クエストやスクリプト自体はバニラのものをいじっていないので、そういう意味
  での競合はありません。
* YACRと条件が被る、OnHitでレイプされるSexLabのAdd Onとは競合します。ひとつ
  のOnHitで2つのモーションが走った時におかしくなると思われます。
  PC死亡時に処理が走るとか、遠距離攻撃時に何かするものとかは多分大丈夫です。
* 戦闘バランス調整系との競合は(自環境では使ってないため)わかりません。
  モーションの発生タイミングがおかしくならなければ、大丈夫だと思いますが……。

* 他の競合については本テキスト一番下のYACR Internalを参照してください。
  これらの要素をいじるModとは、タイミングによって競合、あるいは確実に競合す
  ることがあります。
  特にフォロワーのノックダウン制御に「SetNoBleedoutRecovery」を使用している
  ため、この機能を使って「戦闘終了時までは立ち上がらない」を実現しているフォ
  ロワー制御Modの機能と競合します。


## MCMに出ないニッチな設定

右の数字はデフォルト値です。グローバル変数なので、"set Global変数名 to 数値"で
変更できます。これらの設定はMCMに入れる予定はありません。

### 群衆参加の確率(1人目から5人目)

SSLYACRAudienceChance1 95
SSLYACRAudienceChance2 95
SSLYACRAudienceChance3 95
SSLYACRAudienceChance4 90
SSLYACRAudienceChance5 80

### エンドレスレイプ時の行為分岐確率

コード的には100DとOneMore(もう一度最初から)を比較、OneMoreFromSecond(もう一度
ステージ2から)を比較、複数プレイの条件が合えばSSLYACRMultiPlayと比較、どれも
条件に合わなかったらアニメーションチェンジの順番で処理しています。

複数プレイの場合、条件に合えば、まず100DをSSLYACRMultiPlay5Pと比較、次に
SSLYACRMultiPlay4Pと比較、どれも条件に合わなかったら3P、3Pアニメが無ければ2Pと
いう形になります。

SSLYACROneMore 15
SSLYACROneMoreFromSecond 30
SSLYACRMultiPlay 70
SSLYACRMultiPlay5P 75
SSLYACRMultiPlay4P 75


## アップグレード

特に注記がない限り、更新は上書きするだけです。勝手に再起動するため、戦闘中で
はない、できれば戦闘から時間が経った後で更新してください。


## アンインストール

ロード画面を挟むセル移動後、実時間で10秒待ち、下記のコンソールコマンドを打ち
込んで、セーブしてからアンインストールしてください。
SaveTool.exeなどをその後にかけるとより安全です。

  stopquest sslyacr


## 謝辞

* Bethesda
* Skyrim SexLab & LoversLab
* SexLab Defeat
* SexLab RapeSpell
* Skyrim Battle Test Area
* bbspink Skyrim エロMod晒しスレ
* エンバーシャード鉱山の山賊の皆さん
* 質問スレかどこかで「裸になると戦闘中レイプされるシンプルなModありませんか？」
  と書いたどなたか。全然シンプルじゃないんですが？という言葉は甘んじて受けます。


## 実装した感想

* Defeatってすげぇ！！
* なかなかいう機会がないので改めてこの場を借りて。RapeSpellってすげぇ！！


## 更新履歴

### 2018/11/18 - 2.3 beta

* 主に男PC女フォロワー時用の「PCはレイプされずにノックダウンのみ」機能追加

* 捕捉フォロワーを近場のNPCに限定するように条件追加修正
* フォロワーのブリードアウト時、ペアのレイパーを探す範囲をやや拡大


### 2018/11/14 - 2.2 beta

* エンドレスレイプ時のアニメーション選択のランダム化

* 群衆参加の確率を100%から90%程度まで削減してランダム化
* エンドレスレイプ時の行為分岐を複数プレイの確率を下げる形で調整
 (副作用として、例えば5P=>5Pでもノックダウンを挟むことがあります)
* 上記2項目のグローバル変数化。詳細はReadmeにて。

* MCMの表示がおかしかった部分の修正と未使用項目の削除
* 複数プレイ移行時にノックダウンするようになったため、役目を終えた
  プレイヤーへのSSLYACRPlayerSlowMagicを削除
* for NPC製作時の整理されたコードを移植してコード整理


### 2018/11/07 - 2.1

* パワーアタック専用の確率設定を追加
* ブラックブラッド略奪団を戦闘停止ファクションに追加(from for NPC)

* 絶頂時にちゃんと絶頂イベントを送るように修正(Arousedを下げるため)
* ドラゴンが身体が大きすぎて、わけわからん遠距離近接攻撃の除外対象になってい
  たのを修正

* 影響の少なさそうな敵への横槍=>行為解除時の無敵化を削除


### 2018/10/04 - 2.0

* フォロワーリストにレベルドアクターの名前が表示されていなかった問題を修正
* 「自動でステージを移行しない」などでキー操作が有効になっていた環境で、かつ
  エンドレスレイプが有効な場合、最終ステージだけはキー操作を禁止して自動でス
  テージが移行するように修正
* フォロワーと普通に別れる際もフォロワー復帰処理が走っていた問題を修正
 (バニラのペットフォロワーは一度雇うとTeammate属性が残るようなので、気になる
  ようなら、別れた後にコンソールから setplayerteammate 0 を入れてください)
* ウェアウルフや吸血鬼の王など、人型以外の時は襲われないように修正


### 2018/07/29 - 2.0beta6 (From bbspink Community Thanx!)

* 脱出時、敵を押し倒す際にプレイヤーの前方へPushActorAwayするように変更

* 鎧装備時のレイプ確率が鎧破壊時と同じものになっていたのを修正


### 2018/07/27 - 2.0beta5

* 敵を押し倒していた処理をPushActorAwayに再度変更(Thanx! bbspink 96.860)

* 必要なかったファイルを削除


### 2018/07/26 - 2.0beta4

* SexLabの「終了時の姿勢制御」をYACRの行為には強制OFFに
* PCのレイプ脱出時、敵を押し倒していた処理を麻痺魔法に置き換えて復活

* beta2の「YACRが適用される性別のPC時、フォロワーがブリードアウトした際にPCが選ばれ
  る不具合を修正」した際、プレイヤー以外も除外されていた不具合を修正
* フォロワーがブリードアウトした際に持ち馬がフォロワーを襲う不具合(？)を修正

* 脱出周りのコード整理


### 2018/07/24 - 2.0beta3

* 「PCのレイプ脱出時、敵を押し倒していた処理を一時的に削除」を差し戻し


### 2018/07/22 - 2.0beta2

* PCのレイプ脱出時、敵を押し倒していた処理を一時的に削除
* YACRが適用される性別のPC時、フォロワーがブリードアウトした際にPCが選ばれる不
  具合を修正


### 2018/07/08 - 2.0beta1

* 更新は上書きするだけ。 勝手に再起動するため、YCARの機能が発動していない状態で
  更新すること(この記載をReadmeに移動・以降は記載しない)
 
* 「抵抗する」が成功した時に効果音を追加

* MCMから消した内部設定値「knockdownAll」を毎回強制ONにするよう修正
* レイプ中のアニメーションの制御が詰まった際の復帰処理を調整
* フォロワーのブリードアウト時の挙動を調整(レイパーが近寄る演出削除)
* 山賊とかの「はやしたて」、男PC×女敵NPCの場合は護衛として2人まで、台詞なし、
  女フォロワーレイプがあればそちらをやや優先になるように修正
* セーブデータにスクリプトが残らないようにこまごま修正
* 2.0用にReadmeをこまごま修正


### 2018/07/03 - 2.0alpha2

* 更新は上書きするだけ。 勝手に再起動するため、YCARの機能が発動していない状態で
  更新すること

* Dripping when arousedの潮吹きサポートを追加(副作用ありのため、デフォルトOFF)
* スプリガンだけだった女性扱いクリーチャーにハグレイブンを追加

* 他者治癒など敵対化しない魔法でセックスが中断してしまう問題を修正
* 一部の魔法(特に爆発系)がYACRが有効になるヒット判定になっていたのを修正
* スクリプト残り防止のため、フォロワーブリードアウト時、相手を探す待ち時間を削除


### 2018/06/28 - 2.0alpha1

* 更新は上書きするだけでOKなはず(初回のみ盛大にエラーログ吐きます)
  勝手に再起動するため、YCARの機能が発動していない状態で更新すること
* 「抵抗する」に使うため、Sexlab Aroused Reduxが必須に

* 「抵抗する」キー追加、下2つのキーを含めてアニメ1ステージにつき1回まで
* 抜け出せる確率は性欲＋体力/2を100Dと比較なので、押せばまず抜け出せる
* 「助けを呼ぶ」ホットキー追加。男orペットフォロワーを連れている時限定で機能
  (幻惑のエフェクトになっていますが、特に効果はない)
* 「全てをあきらめる」ホットキーを追加(特に演出はない・ロードする代わり)
  対応が簡単だったので↑キーでSimple Slaveryを使うように設定可(5.31でテスト)

* 適用ファクション事前設定廃止。対応アニメがある全てのNPCに対応
  (ただし、周りのNPCの戦闘停止はMod追加ファクションには機能しない)
* 上記に伴って、ドラゴンなど単体で出現する敵用の除外種族設定を追加
* 複数プレイ事前設定廃止。対応アニメがあれば自動で全てに対応
  (リークリング4Pない問題にも対応。Mod追加Raceには機能しない)

* レイパーの性別設定を追加(敵女NPCでの複数プレイとかは適当)
* レイプが起こる体力の下限設定を追加
* バージョンアップ時、自動でクエストを再起動する機能を追加

* エンドレスレイプのアニメ変更時、ステージ2から再生するように変更
* アニメの取り合いを防ぐため、YACR環境下のPC/女性フォロワーが他のModのセックス
  中にYACRが発動しうる攻撃を受けた場合、セックスを中断するように変更
* 「鎧脱衣モード」をPC/フォロワーそれぞれ個別に設定できるように変更
* 群衆の接近距離を少し遠ざける形で変更
* PCへのレイプをデフォルト有効に変更

* MCM整理(「ノックダウンモード」の設定欄廃止)
* その他いろいろ

* 「助けを呼ぶ」について多分聞かれるであろう質問とその答え
  Q: フォロワーが走ってきてPCレイプしてる敵を切りつけるじゃダメだったの？
  A: (おそらくFLPの機能の)同士討ちを避ける強制力を突破できませんでした


### 2018/06/28 - 1.0

* 更新は上書きするだけ
* レベルドリスト生成のNPCの性別判定の不具合を修正
* rc1で追加した「サポート外クリーチャーの即スルー」の不具合を修正


### 2018/06/06 - 1.0rc1

* 更新は上書き後、コンソールから stopquest sslyacr → startquest sslyacr

* Dwarven Automaton Factionを追加
* Spider Factionを追加
* 1行パッチで対応した鎧脱衣モードを簡易的に追加(PC/フォロワー共通)

* PCへのレイプ確定時、ノックダウンモーションを取るように変更

* 適用ファクションの中でサポートされていないクリーチャーの場合、即座にス
  ルーするように修正(例: ドワーフスフィア)
* エンドレスループ時、最終ステージの時間をSexLab設定-1.5秒取るように修正
* 無敵化しているせいで付かなかった精液を一瞬無敵化を解除して付くように修正
* PCレイプ時、フォロワーをノックダウンさせる処理が適用されなかった時のため、
  PCのアニメステージの進行時に、再度ノックダウンしていないフォロワーを処理
  するよう修正
* MCMで「アーマーブレイクの発生確率には影響しない（キリッ」と書いてたくせに
  ばっちり影響していた、ヘルスの割合設定値⇔アーマーブレイクの確率の関係を
  修正

* デバッグ用にMCMにフォロワーリスト表示を追加
* デバッグエフェクトを目立たないレベルまで削減


### 2018/01/23 - アルファ４

* 更新は上書き後、コンソールから stopquest sslyacr → startquest sslyacr

* 普通に別れたフォロワーにもフォロワー復帰処理が走ってしまっていた問題を修正


### 2017/12/25 - アルファ３

* 更新は上書き後、コンソールから stopquest sslyacr → startquest sslyacr

* PCの性別にかかわらず、PCに有効かどうかはMCMで設定するように変更
* エンドレスレイプ中断時、アニメ取得失敗が原因の場合、左上にメッセージを
  表示するように(MCMで非表示設定可)
* 攻撃の同時ヒット時、レイパー2人の行為が1人に対して重複して発動してしま
  う問題の対策の強化

* 将来的に使う予定だったPCのInvisibility設定変更を削除
* MCM整理・コード整理


### 2017/12/20 - アルファ２

* 更新は上書き後、コンソールから stopquest sslyacr → startquest sslyacr
* MCMの「敵」「複数プレイ」はデフォルトに戻るかもしれません

* Skeleton Factionを追加
* 群衆Aliasから、dunPrisonerFactionキャラを除外(Sexy Bandit Captives対策に)
* 複数プレイのヘルパーAliasから、dunPrisonerFactionキャラを除外
* フォロワー外れ対策を強化

* ResetAIの頻度減少
* 繰り返しフォロワーが同じ相手に襲われていると戦闘AIが起動しなくなる問題の修正
  (StopCombat() / StopCombatAlarm() の見直し)
* 群衆Aliasにレイプされている味方が入ってしまう問題を修正
* アニメーションの復帰処理がずっと走り続けていた問題を修正(アルファ１のセーブ
  データでも、アルファ２を入れたら止まります）


### 2017/12/18 - アルファ１（初回リリース）


--------------------



## YACR Internal - 雑多な情報

* レイプ発動時、全員に防御力をあげるSSLYACRKillmoveArmorSpellをかけます。
  やや抑えめですがピンクのパーティクルエフェクトが出るため、処理がおおよそ正常に走って
  いるかどうかはこれで判断してください。

* レイプ発動時にいじる要素は下記。解除時には元に戻します。
 * PCレイプ時
  * Alias VictimPlayerに入ることで下記になります。レイプ終了時にAliasから外します。
  * dunPrisonerFaction+DLC2Rieakling Faction+...という感じの友好ファクションに加入
  * レイパーとの共同ファクションSSLYACRCalmFactionに加入
  * SetGhost
  * SSLYACRKillmoveArmorSpell(無敵になってるから必要ないけど念のため)
  * SSLYACRPlayerSlowMagic(移動力を落とします)
 * フォロワーレイプ時
  * VictimFemaleFollower1～5に入ることで下記になります。レイプ終了時にAliasから外します。
  * dunPrisonerFaction+DLC2Rieakling Faction+...という感じの友好ファクションに加入
  * SetGhost
  * SSLYACRKillmoveArmorSpell(無敵になってるから必要ないけど念のため)
  * CurrentFollowerFaction/CurrentHireling解除
  * Teammate属性解除
 * PCレイプ時のフォロワーのノックダウン
  * SetNoBleedoutRecovery(人型)
  * SSLYACRParalyseMagic(クリーチャー)

* OnCellLoadの5秒後にクエストの再起動を行います。フォロワーの読み直しなどが行われます。
  再起動の前に、バグやタイミングの悪さで元に戻っていなかった時のことを考慮して、戦闘状
  態にいじっていたすべての要素を可能な限り再度元に戻します。
  OnCellLoadの前にフォロワーに発生するOnCellDetachにもこの処理が含まれています。
  
* ここまで読んでくれた方におまけ： フォロワーのエンドレスレイプを試験していた時に使った
  PCのInvisibilityを1にして発見されにくくする指輪が入っています。AddItemMenuなどで入手
  可能です。


