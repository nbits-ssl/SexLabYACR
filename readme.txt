SexLab Yet Another Combat Rape        but still simple & lightweight
====================================================================

******* このModはアルファ版です。変なことになっても泣かない ********
*******       入れる前のセーブデータのバックアップ必須      ********

SSL用の戦闘レイプMod。Defeatが自環境ではうまく動かないため、簡易的な
ものを作成しました。
元々は裸のPC/フォロワーにペナルティを与える目的で製作したものです。

基本和姦好きで戦闘でレイプされることにあまり重きをおいていないので、
通常のゲームプレイにあまり影響が出ないように、なおかつ気を抜くとたま
にレイプされるような感じが目標です。

自環境がフォロワーをたくさん連れて敵もたくさん沸かせる環境なので、
複雑な機能の実装の予定はありません。
(一番忙しい戦闘時にいろいろするModなため、乱打戦になると大変)


## 概要

* 防御せずに直接攻撃を受けた時に、MCMの設定に応じた条件・確率でレイプが
  発動します。
* Loot and DegradationやTAWoBA - Armor Breakなどの併用を想定していますが、
  このMod自体にも女性の胴装備のみのアーマーブレイクは実装しています。
* PC/女性フォロワーを1人＋5人まで認識します。全ての機能が適用されます。
  PCについてはMCMで有効/無効を切り替えられます。
* 男性フォロワーとペットを5人/3匹まで認識します。PCがレイプされた時に、
  ブリードアウト/麻痺状態になります。
* フォロワーでないNPCは認識しません。
* レイプを開始した攻め側キャラに攻撃可能です。
* PC/フォロワーがレイプされているときに↑の横槍が入ると、中断します。
  「だいたいの場合は横槍が入る」ことを想定して機能は実装しています。
* 体力が0以下となったPCには発動しません。死亡時など。
* 敵が山賊などの人間種族の場合、ギャラリーがいればはやし立てます。
  (TFC発動時は見えません)


## 注意事項

* 発生確率を100%にしても、必ず発生するわけではありません。
* モーション中に死亡した死体硬直防止処理のため、床をすり抜けて消える死体
  が発生する可能性があります。ある程度は防止しますが、達人魔法とかでは発
  生するかもしれません。あまりあることではないので、仕様で。
* ユニーク装備の鎧とかでも容赦なく壊します。
* PCレイプ時、諸々の事情により移動力を落とす魔法をPCにかけています。
  レイプからの復帰時に症状が残っている場合は、少しだけスプリントしてくだ
  さい。
* 女性のみのパーティーで全員レイプされると、エンドレスレイプ有効の場合は
  バグなどの中断による場合を除き、ほぼ復帰できなくなります。仕様です。
  自分でロードするなりなんなりでリセットしてください。
  (ただ、たいていロードするとCTDすると思います。どうしようか考え中）
* 合致するアニメーションがない場合、行為は中断されます。この場合でも終了
  処理は正常に走ります。人間2Pと3PはSexLab MCMから設定できるレイプアニメ
  ーションでなければなりません。
* オオカミが複数プレイ適合ファクションになっていますが、アニメはなかった
  気がします。というのは勘違いで、あるらしいです。ない場合は0から動かさ
  ないでください。
* リークリングは5Pはあるが4Pはないという特殊な状態らしいです。5P設定にし
  た場合、4Pの人数しかそろわなかった時は行為が中断されます。
  対応アニメを自動的に探すのは、速度との兼ね合いを見て将来的に検討します。
* 特別な管理をされているフォロワーを連れ歩く場合は、特にセーブデータの管
  理に注意を。
* 保護/不死じゃないフォロワーのことはまったく考えていません。PCレイプ時に
  フォロワーをノックダウンさせる際、実際にダメージを与えているため、現状
  だと確実に死亡します。手が空いたら一時的に保護属性をつける予定です。
* 殴り合いイベントのこととかまったく考えていません。


## 既知の問題

* フォロワーがレイプされた時、他のフォロワーが助けに行かず戦闘状態を解除
  することがあります。自分で横槍を入れてください。
* 機能発動の後遺症を残さないために、戦闘が終わったタイミングでResetAIを発
  行しているため、フォロワーが抜刀と納刀を繰り返すことがあります。放って
  おけば治ります。
* たまに横槍を入れても止まらずに無敵化するレイパーがいます。アニメーション
  が1段階進むと無敵化が解けますので、再度横槍を入れてください。
* 動作がおかしくなることはないと思いますが、PCが召喚とか死霊術を使った場合、
  想定通りに事が進まないと思います。(DLCなしのバニラの範囲の召喚は、何と
  なく対策コードは入っています)


## 「ノックダウンモード」

* デフォルトではPCがレイプされた場合、フォロワーは戦闘を停止してブリード
  アウト状態になります。PCがレイプから逃れるとこのブリードアウト状態は解
  除されます。
* ノックダウンモードのチェックを外すと、上記の機能が解除され、PCがレイプ
  されているときに、敵に横槍を入れてくれるようになります。これが本来の仕
  様になるはず「でした」。
* ノックダウンモードのチェックを外すと、PCレイプ時の戦闘中止処理もなくな
  るため、無敵になったレイプされているPCに対し、敵が攻撃を試みます。
  試してみるとよくわかるのですが、これが非常に煩わしいため、現状ではチェ
  ックを外すことは非推奨です。


## 必須

* Skyrim OE + Dawnguard + Dragonborn
* Skyrim SexLab 1.62
* SexLab Aroused Redux


## 製作環境で関係ありそうなModや設定

* SexLab基本設定"Disable Starting Teleport"をOFFに
* FollowerLivePackage (多くてもPC+女性フォロワー3人までくらいです)
* Loot and Degradation
* Armor Rating Rescaled - SKSE
* 戦闘関係はCombat Evolvedの設定値消去版だけ
* SexLabのシーン自体をフックするAdd On(SLSOとか？)なし
* Fresh Women Darkness
* More Nasty Critters 11.1D


## 競合について

* クエストやスクリプト自体はバニラのものをいじっていないので、そういう意味
  での競合はありません。
* YACRと条件が被る、OnHitでレイプされるSexLabのAdd Onとは競合します。ひとつ
  のOnHitで2つのモーションが走った時におかしくなると思われます。
  PC死亡時に処理が走るとか、遠距離攻撃時に何かするものとかは多分大丈夫です。
* 戦闘バランス調整系との競合は(自環境では使ってないため)わかりません。
  モーションの発生タイミングがおかしくならなければ、大丈夫だと思いますが……。
* 他の競合については本テキスト一番下のYACR Internalを参照してください。
  これらの要素をいじるModとは、タイミングによって競合、あるいは確実に競合す
  ることがあります。
  特にフォロワーのノックダウン制御に「SetNoBleedoutRecovery」を使用している
  ため、この機能を使って「戦闘終了時までは立ち上がらない」を実現しているフォ
  ロワー制御Modの機能と競合します。


## アンインストール

ロード画面を挟むセル移動後、実時間で10秒待ち、下記のコンソールコマンドを打ち
込み、セーブしてからアンインストールしてください。SaveTool.exeなどをその後に
かけるとより安全です。

  stopquest sslyacr


## 謝辞

* Bethesda
* Skyrim SexLab & LoversLab
* SexLab Defeat
* SexLab RapeSpell
* Skyrim Battle Test Area
* bbspink Skyrim エロMod晒しスレ
* エンバーシャード鉱山の山賊の皆さん
* 質問スレかどこかで「裸になると戦闘中レイプされるシンプルなModありませんか？」
  と書いたどなたか。全然シンプルじゃないんですが？という言葉は甘んじて受けます。


## 実装した感想

* Defeatってすげぇ！！
* なかなかいう機会がないので改めてこの場を借りて。RapeSpellってすげぇ！！


## 更新履歴


### 2018/06/** - 2.0alpha1

* 更新は上書き後するだけでOKなはず(初回のみ盛大にエラーログ吐きます)
* 「抵抗する」に使うため、Sexlab Aroused Reduxが必須に

* 「抵抗する」キー追加、下2つのキーを含めてアニメ1ステージにつき1回まで
* 抜け出せる確率は性欲＋体力/2を100Dと比較なので、押せばまず抜け出せる
* 「助けを呼ぶ」ホットキー追加。男orペットフォロワーを連れている時限定で機能
* 「全てをあきらめる」ホットキーを追加(特に演出はない・ロードする代わり)
  対応が簡単だったので↑キーでSimple Slaveryを使うように設定可(5.31でテスト)

* 適用ファクション事前設定廃止。対応アニメがある全てのNPCに対応
  (ただし、周りのNPCの戦闘停止はMod追加ファクションには機能しない)
* 複数プレイ事前設定廃止。対応アニメがあれば自動で全てに対応
  (リークリング4Pない問題にも対応。Mod追加Raceには機能しない)

* レイパーの性別設定を追加(複数プレイとか真面目にテストしてない)
* レイプが起こる体力の下限設定を追加
* バージョンアップ時、自動でクエストを再起動する機能を追加

* 「鎧脱衣モード」をPC/フォロワーそれぞれ個別に設定できるように修正

* MCM整理(「ノックダウンモード」の設定欄廃止)
* コード整理

* 「助けを呼ぶ」について多分聞かれるであろう質問とその答え
  Q: フォロワーが走ってきてPCレイプしてる敵を切りつけるじゃダメだったの？
  A: (おそらくFLPの機能の)同士討ちを避ける強制力を突破できませんでした


### 2018/06/06 - 1.0rc1

* 更新は上書き後、コンソールから stopquest sslyacr → startquest sslyacr

* Dwarven Automaton Factionを追加
* Spider Factionを追加
* 1行パッチで対応した鎧脱衣モードを簡易的に追加(PC/フォロワー共通)

* PCへのレイプ確定時、ノックダウンモーションを取るように変更

* 適用ファクションの中でサポートされていないクリーチャーの場合、即座にス
  ルーするように修正(例: ドワーフスフィア)
* エンドレスループ時、最終ステージの時間をSexLab設定-1.5秒取るように修正
* 無敵化しているせいで付かなかった精液を一瞬無敵化を解除して付くように修正
* PCレイプ時、フォロワーをノックダウンさせる処理が適用されなかった時のため、
  PCのアニメステージの進行時に、再度ノックダウンしていないフォロワーを処理
  するよう修正
* MCMで「アーマーブレイクの発生確率には影響しない（キリッ」と書いてたくせに
  ばっちり影響していた、ヘルスの割合設定値⇔アーマーブレイクの確率の関係を
  修正

* デバッグ用にMCMにフォロワーリスト表示を追加
* デバッグエフェクトを目立たないレベルまで削減

### 2018/01/23 - アルファ４

* 更新は上書き後、コンソールから stopquest sslyacr → startquest sslyacr

* 普通に別れたフォロワーにもフォロワー復帰処理が走ってしまっていた問題を修正

### 2017/12/25 - アルファ３

* 更新は上書き後、コンソールから stopquest sslyacr → startquest sslyacr

* PCの性別にかかわらず、PCに有効かどうかはMCMで設定するように変更
* エンドレスレイプ中断時、アニメ取得失敗が原因の場合、左上にメッセージを
  表示するように(MCMで非表示設定可)
* 攻撃の同時ヒット時、レイパー2人の行為が1人に対して重複して発動してしま
  う問題の対策の強化

* 将来的に使う予定だったPCのInvisibility設定変更を削除
* MCM整理・コード整理

### 2017/12/20 - アルファ２

* 更新は上書き後、コンソールから stopquest sslyacr → startquest sslyacr
* MCMの「敵」「複数プレイ」はデフォルトに戻るかもしれません

* Skeleton Factionを追加
* 群衆Aliasから、dunPrisonerFactionキャラを除外(Sexy Bandit Captives対策に)
* 複数プレイのヘルパーAliasから、dunPrisonerFactionキャラを除外
* フォロワー外れ対策を強化

* ResetAIの頻度減少
* 繰り返しフォロワーが同じ相手に襲われていると戦闘AIが起動しなくなる問題の修正
  (StopCombat() / StopCombatAlarm() の見直し)
* 群衆Aliasにレイプされている味方が入ってしまう問題を修正
* アニメーションの復帰処理がずっと走り続けていた問題を修正(アルファ１のセーブ
  データでも、アルファ２を入れたら止まります）

### 2017/12/18 - アルファ１（初回リリース）


--------------------



## YACR Internal - 雑多な情報

* レイプ発動時、全員に防御力をあげるSSLYACRKillmoveArmorSpellをかけます。
  ピンクのエフェクトが出るため、処理がおおよそ正常に走っているかどうかはこれで判断して
  ください。

* レイプ発動時にいじる要素は下記。解除時には元に戻します。
 * PCレイプ時
  * 相手のファクションに加入(ノックダウンモードの場合)
  * レイパーとの共同ファクションSSLYACRCalmFactionに加入
  * SetGhost
  * SSLYACRKillmoveArmorSpell(無敵になってるから必要ないけど念のため)
  * SSLYACRPlayerSlowMagic(移動力を落とします)
 * フォロワーレイプ時
  * 相手のファクションに加入
  * SetGhost
  * SSLYACRKillmoveArmorSpell(無敵になってるから必要ないけど念のため)
  * CurrentFollowerFaction/CurrentHireling解除
  * Teammate属性解除
 * PCレイプ時のフォロワーのノックダウン
  * SetNoBleedoutRecovery(人型)
  * SSLYACRParalyseMagic(クリーチャー)

* OnCellLoadの5秒後にクエストの再起動を行います。フォロワーの読み直しなどが行われます。
  再起動の前に、バグやタイミングの悪さで元に戻っていなかった時のことを考慮して、戦闘状
  態にいじっていたすべての要素を可能な限り再度元に戻します。
  OnCellLoadの前にフォロワーに発生するOnCellDetachにもこの処理が含まれています。
  
* ここまで読んでくれた方におまけ： フォロワーのエンドレスレイプを試験していた時に使った
  PCのInvisibilityを1にして発見されにくくする指輪が入っています。AddItemMenuなどで入手
  可能です。


